# ğŸ”§ æ­·å²è¨˜éŒ„æ•…éšœæ’é™¤æŒ‡å—

å¦‚æœä½ åœ¨æŸ¥çœ‹æ­·å²è¨˜éŒ„æ™‚é‡åˆ°å•é¡Œï¼Œè«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿæ’é™¤æ•…éšœï¼š

## ğŸ” å•é¡Œè¨ºæ–·

### 1. Firebase é€£æ¥ç‹€æ…‹æª¢æŸ¥
- æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (F12)
- æŸ¥çœ‹ Console æ¨™ç±¤é ï¼Œå°‹æ‰¾ Firebase ç›¸é—œçš„éŒ¯èª¤è¨Šæ¯
- æŸ¥çœ‹æ˜¯å¦æœ‰ä»¥ä¸‹é¡å‹çš„éŒ¯èª¤ï¼š
  - `permission-denied`: æ¬Šé™å•é¡Œ
  - `unavailable`: Firebase æœå‹™ä¸å¯ç”¨
  - `failed-precondition`: ç´¢å¼•æœªå»ºç«‹

### 2. ç¶²è·¯é€£æ¥æª¢æŸ¥
- ç¢ºèªç¶²è·¯é€£æ¥æ­£å¸¸
- å˜—è©¦é‡æ–°æ•´ç†é é¢
- æª¢æŸ¥æ˜¯å¦æœ‰é˜²ç«ç‰†é˜»æ“‹ Firebase é€£æ¥

## ğŸ› ï¸ è§£æ±ºæ–¹æ¡ˆ

### Firebase å®‰å…¨è¦å‰‡è¨­å®š

1. **ç™»å…¥ Firebase æ§åˆ¶å°**
   - è¨ªå• [Firebase Console](https://console.firebase.google.com/)
   - é¸æ“‡ä½ çš„å°ˆæ¡ˆ `squash-72502`

2. **æ›´æ–° Firestore å®‰å…¨è¦å‰‡**
   - åœ¨å·¦å´é¸å–®ä¸­é¸æ“‡ "Firestore Database"
   - é»æ“Š "è¦å‰‡" æ¨™ç±¤
   - å°‡ä»¥ä¸‹è¦å‰‡è¤‡è£½ä¸¦è²¼ä¸Šï¼š

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // å…è¨±è®€å–æˆ¿é–“è³‡è¨Š
    match /rooms/{roomId} {
      allow read: if true;
      allow create, update: if true;
      allow delete: if false; // ä¿è­·æ­·å²è³‡æ–™
    }
    
    // å…è¨±è®€å–éŠæˆ²è³‡è¨Š
    match /games/{gameId} {
      allow read, write: if true;
    }
    
    // å…è¨±è®€å–å…¶ä»–é›†åˆ
    match /players/{playerId} {
      allow read, write: if true;
    }
    
    match /matches/{matchId} {
      allow read, write: if true;
    }
  }
}
```

3. **ç™¼å¸ƒè¦å‰‡**
   - é»æ“Š "ç™¼å¸ƒ" æŒ‰éˆ•
   - ç­‰å¾…è¦å‰‡ç”Ÿæ•ˆï¼ˆé€šå¸¸éœ€è¦å¹¾åˆ†é˜ï¼‰

### å»ºç«‹ Firestore ç´¢å¼•

å¦‚æœå‡ºç¾ç´¢å¼•ç›¸é—œéŒ¯èª¤ï¼Œéœ€è¦å»ºç«‹ä»¥ä¸‹ç´¢å¼•ï¼š

1. **åœ¨ Firebase æ§åˆ¶å°ä¸­**ï¼š
   - é€²å…¥ "Firestore Database" > "ç´¢å¼•"
   - å»ºç«‹è¤‡åˆç´¢å¼•ï¼š
     - é›†åˆï¼š`rooms`
     - æ¬„ä½1ï¼š`status` (å‡åº)
     - æ¬„ä½2ï¼š`lastActivity` (é™åº)

2. **æˆ–è€…è®“ç³»çµ±è‡ªå‹•å»ºç«‹**ï¼š
   - ç•¶ä½ ç¬¬ä¸€æ¬¡æŸ¥çœ‹æ­·å²è¨˜éŒ„æ™‚
   - Firebase æœƒåœ¨æ§åˆ¶å°ä¸­é¡¯ç¤ºå»ºç«‹ç´¢å¼•çš„é€£çµ
   - é»æ“Šé€£çµæœƒè‡ªå‹•å»ºç«‹æ‰€éœ€çš„ç´¢å¼•

### æ¸¬è©¦æ­¥é©Ÿ

1. **å‰µå»ºæ¸¬è©¦è³‡æ–™**ï¼š
   - é–‹å§‹ä¸€å ´æ–°çš„å¤šäººæ¯”è³½
   - é€²è¡Œå¹¾å ´å°æˆ°
   - çµæŸæ¯”è³½
   - é€™æœƒåœ¨ Firebase ä¸­å‰µå»ºçœŸå¯¦çš„æ­·å²è¨˜éŒ„

2. **é©—è­‰è³‡æ–™**ï¼š
   - åœ¨ Firebase æ§åˆ¶å°ä¸­æª¢æŸ¥ `rooms` é›†åˆ
   - ç¢ºèªæœ‰ `status: 'completed'` çš„è¨˜éŒ„
   - æª¢æŸ¥è¨˜éŒ„æ˜¯å¦åŒ…å« `finalResults` è³‡æ–™

3. **é‡è©¦æ­·å²è¨˜éŒ„**ï¼š
   - è¿”å›æ‡‰ç”¨ç¨‹å¼
   - é»æ“Š "æŸ¥çœ‹æ­·å²è¨˜éŒ„"
   - æ‡‰è©²èƒ½çœ‹åˆ°çœŸå¯¦çš„æ¯”è³½è¨˜éŒ„

## ğŸš¨ å¸¸è¦‹éŒ¯èª¤å’Œè§£æ±ºæ–¹æ³•

### éŒ¯èª¤ï¼š`FirebaseError: Missing or insufficient permissions`
**è§£æ±ºæ–¹æ³•**ï¼š
- æŒ‰ç…§ä¸Šè¿°æ­¥é©Ÿæ›´æ–° Firestore å®‰å…¨è¦å‰‡
- ç¢ºä¿è¦å‰‡ä¸­åŒ…å« `allow read: if true;`

### éŒ¯èª¤ï¼š`FirebaseError: The query requires an index`
**è§£æ±ºæ–¹æ³•**ï¼š
- è¤‡è£½éŒ¯èª¤è¨Šæ¯ä¸­çš„ç´¢å¼•å»ºç«‹é€£çµ
- é»æ“Šé€£çµåœ¨ Firebase æ§åˆ¶å°ä¸­å»ºç«‹ç´¢å¼•
- ç­‰å¾…ç´¢å¼•å»ºç«‹å®Œæˆï¼ˆå¯èƒ½éœ€è¦å¹¾åˆ†é˜ï¼‰

### éŒ¯èª¤ï¼š`FirebaseError: Firestore has not been initialized`
**è§£æ±ºæ–¹æ³•**ï¼š
- æª¢æŸ¥ `src/config/firebase.js` ä¸­çš„é…ç½®æ˜¯å¦æ­£ç¢º
- ç¢ºèª Firebase å°ˆæ¡ˆ ID æ˜¯ `squash-72502`
- é‡æ–°æ•´ç†é é¢

### é€£æ¥ç‹€æ…‹é¡¯ç¤º "âŒ é€£æ¥å¤±æ•—"
**è§£æ±ºæ–¹æ³•**ï¼š
1. æª¢æŸ¥ç¶²è·¯é€£æ¥
2. ç¢ºèª Firebase æœå‹™ç‹€æ…‹
3. æ¸…é™¤ç€è¦½å™¨å¿«å–ä¸¦é‡æ–°è¼‰å…¥
4. æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°çš„è©³ç´°éŒ¯èª¤è¨Šæ¯

## ğŸ“ æ”¯æ´è³‡è¨Š

å¦‚æœå•é¡Œä»ç„¶å­˜åœ¨ï¼š

1. **æª¢æŸ¥ Firebase å°ˆæ¡ˆè¨­å®š**ï¼š
   - å°ˆæ¡ˆ ID: `squash-72502`
   - å€åŸŸ: asia-east1 (æ¨è–¦)

2. **è¯ç¹«è³‡è¨Š**ï¼š
   - GitHub Issues: [sgame-tournament/issues](https://github.com/yanchen184/sgame-tournament/issues)
   - æä¾›å®Œæ•´çš„éŒ¯èª¤è¨Šæ¯å’Œç€è¦½å™¨æ§åˆ¶å°æˆªåœ–

3. **debug è³‡è¨Šæ”¶é›†**ï¼š
   ```javascript
   // åœ¨ç€è¦½å™¨æ§åˆ¶å°ä¸­åŸ·è¡Œ
   console.log('Firebase Config:', window.firebase?.apps?.[0]?.options);
   console.log('Connection Status:', navigator.onLine);
   ```

## âœ… æˆåŠŸæŒ‡æ¨™

æ­·å²è¨˜éŒ„åŠŸèƒ½æ­£å¸¸é‹ä½œæ™‚ï¼Œä½ æ‡‰è©²çœ‹åˆ°ï¼š

- âœ… Firebase å·²é€£æ¥ï¼ˆç¶ è‰²ç«ç„°åœ–ç¤ºï¼‰
- âœ… é€£æ¥ç‹€æ…‹é¡¯ç¤ºç‚º "âœ… Firebase å·²é€£æ¥"
- âœ… æ­·å²è¨˜éŒ„é é¢é¡¯ç¤ºå¯¦éš›çš„æ¯”è³½è³‡æ–™
- âœ… èƒ½å¤ é»æ“Šæ¯”è³½å¡ç‰‡æŸ¥çœ‹è©³ç´°è³‡è¨Š
- âœ… çµ±è¨ˆè³‡æ–™æ­£ç¢ºè¨ˆç®—ä¸¦é¡¯ç¤º