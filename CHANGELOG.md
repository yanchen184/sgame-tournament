# 更新日誌

## v3.1.0 - 2025-01-03

### 🐛 Bug 修復
- **修復選擇狀態問題**：解決了 C 在第二場（CD）獲勝後，在第三場（CA）中被錯誤選中的問題
- **防重複提交**：添加了 `isSubmitting` 狀態，防止重複提交比賽結果
- **強制重新渲染**：使用 `selectionKey` 確保選擇區域在比賽變化時完全重新渲染

### 🎨 UI 改進
- **按鈕尺寸優化**：
  - 確認結果按鈕：更大的尺寸 (22px × 45px padding)
  - 撤銷按鈕：更大的尺寸 (20px × 40px padding)  
  - 結束比賽按鈕：更大的尺寸 (24px × 48px padding)
- **版本號顯示**：在頁面右上角顯示當前版本號
- **積分榜位置**：移動到頁面頂部，使用漸層設計

### 🔧 功能改進
- **積分系統**：確保贏得比賽的玩家獲得 1 分
- **撤銷功能**：添加撤銷上一步操作的功能
- **結束比賽**：添加手動結束比賽的功能
- **狀態管理**：改進比賽狀態的清除機制

### 📋 技術改進
- **調試日誌**：添加詳細的調試日誌，方便問題追蹤
- **狀態追蹤**：改進了選擇狀態的追蹤和清除機制
- **防抖機制**：添加延遲清除選擇狀態的機制

### 🎯 核心修復
解決了 React 狀態更新異步導致的選擇狀態殘留問題：
1. 使用 `selectionKey` 強制重新渲染選擇組件
2. 在多個生命週期階段清除選擇狀態
3. 為每個比賽創建唯一的選擇元素標識符

---

## v3.0.0 - 2024-12-XX
- 初始的固定順序賽制實現
- 基本的 4 人比賽功能
- 資料庫同步功能
